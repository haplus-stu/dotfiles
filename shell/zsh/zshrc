source $HOME/config/scripts/utils.sh
check_OS

#alias
alias tkill="tmux kill-server"
alias memo="rusmo"
alias g="git"
alias mkdir="mkdir -p"
alias d="docker"
alias dc="docker-compose"
alias ds="sh $HOME/config/scripts/docker.sh"
alias cp="cp -r"
alias alldel="bash ~/dotfiles/docker/all_down.sh"
alias fdown="docker-compose down --rmi all --volumes --remove-orphans"
alias recon="source ~/.${SHELL##*/}rc"
alias shconf="$EDITOR ~/.${SHELL##*/}rc"
alias vim="nvim"
alias zi="zoxide"
alias cls="clear"
alias diff="vimdiff"
alias ys="yay -S"
#change dir
alias cdw="cd ~/workspace/"
alias cdv="cd ~/vagrant/"
alias cdd="cd ~/config/"

#only mac
if [[ ${OS} == "Mac" ]]; then
  alias ls="ls -G"
  alias ll="ls -lG"
else
alias ls="ls --color"
alias ll="ls -l --color";
fi


eval "$(zoxide init zsh)"
# eval "$(starship init zsh)"



[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh


function select-history() {
  BUFFER=$(history -n -r 1 | fzf --no-sort +m --query "$LBUFFER" --prompt=">> ")
  CURSOR=$#BUFFER
}

zle -N select-history
bindkey '^r' select-history

function ghq-fzf() {
  local src=$(ghq list | fzf --preview "ls -laTp $(ghq root)/{} | tail -n+4 | awk '{print \$9\"/\"\$6\"/\"\$7 \" \" \$10}'")
  if [ -n "$src" ]; then
    BUFFER="cd $(ghq root)/$src && ls"
    zle accept-line
    zle -R -c
  fi

}
zle -N ghq-fzf
bindkey '^[' ghq-fzf

# 履歴ファイルの保存先
export HISTFILE=${HOME}/.zsh_history

# メモリに保存される履歴の件数
export HISTSIZE=100

# 履歴ファイルに保存される履歴の件数
export SAVEHIST=10000

# norecord duplicate command
setopt hist_ignore_dups

#no record history command
setopt hist_no_store

setopt hist_save_no_dups

setopt auto_cd
cdpath=(.. ~ ~/workspace)

setopt correct

#do not create .lesshist
export LESSHISTFILE=-

autoload -Uz compinit && compinit

PS1="%n@%m:%~$ "
